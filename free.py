import subprocess
import requests


def test_zap_policy():
    zap_path = r"./ZAP_2.15.0/zap.sh"
    api_key = "pu4vgbomo7jo4tr3au66ols6f8"
    port = "8090"
    
    new_policy_name = "test_policy"
    command = f"{zap_path} -daemon -port {port} -config api.key={api_key}"
    process = subprocess.Popen(command, shell=True)

    policy_new = f"http://localhost:{port}/JSON/ascan/action/addScanPolicy/?apikey={api_key}&scanPolicyName={new_policy_name}"
    policy_response = requests.get(policy_new)

    print("Pass Test")

def main():
    test_zap_policy()

if __name__ == "__main__":
    main()